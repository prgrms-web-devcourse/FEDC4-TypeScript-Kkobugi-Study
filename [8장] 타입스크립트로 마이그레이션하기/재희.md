# 아이템 58. 모던 자바스크립트로 작성하기

- ECMAScript 모듈 사용하기
  - ES2015부터는 import와 export를 사용하는 ECMAScript 모듈이 표준이 되었다.
  - ES 모듈 시스템으로 전환하는 것이 좋다.
- 프로토타입 대신 클래스 사용하기
  - 클래스 기반 객체가 더 간결하고 직관적이다.
  - 타입스크립트의 언어 서비스를 활용해 간단히 클래스 객체로 전환도 가능하다.
- var 대신 let/const 사용하기
  - var는 스코프 문제 등 여러 잠재적 문제가 있다.
- for 문 대신 for-of 또는 배열 메서드 사용하기
  - 코드가 간결하고, 인덱스 변수 등도 줄일 수 있다.
- 함수 표현식보다 화살표 함수 사용하기
  - this 스코프의 혼동을 줄일 수 있다.
  - `noImplicitThis` 옵션을 사용하자
- 단축 객체 표현과 구조 분해 할당 사용하기
  - 단축 객체 표현, 객체 구조 분해 등을 사용해주자.
  - 문법이 간결해지고 변수 사용 시 실수가 줄어든다.
- 함수 매개변수 기본값 사용하기
  - 매개변수에 기본값을 지정하면 타입 추론이 용이해지고 선택적 매개변수를 나타낼 수 있다.
- 저수준 프로미스나 콜백 대신 async/await 사용하기
- 연관 배열에 객체 대신 Map과 Set 사용하기
  - 객체는 ‘constructor’ 파라미터에 대해 예상치 못한 결과를 나타내는 등의 문제가 있다.
  - Map과 Set을 사용하자
- 타입스크립트에 use strict 넣지 않기
  - 타입스크립트의 설정으로 인한 체크가 더욱 엄격하다.

# 아이템 59. 타입스크립트 도입 전에 @ts-check와 JSDoc으로 시험해 보기

- @ts-check 지시자를 사용하면 타입스크립트 전환시에 어떤 문제가 발생하는지 미리 시험해볼 수 있다.
  - 어디까지나 느슨한 수준이다.
- 선언되지 않은 전역 변수
  - HTML 파일 내의 <script> 태그 등 변수를 인식하기 힘든 상황이라면 타입 선언 파일을 별도로 만들어야 한다.
  - d.ts 파일을 만들어주자
- 알 수 없는 라이브러리
  - types를 설치해준다.
  - @ts-check를 사용하면 타입스크립트 마이그레이션 전에 서드파티 라이브러리들의 타입 선언을 활용하여 타입 체크를 시험해 볼 수 있다.
- DOM 문제
  - 단언문을 사용해야 하는 경우가 있다.
  - 하지만 자바스크립트에서는 불가하니 JSDoc을 사용하여 대체해 줄 수 있다.
- 부정확한 JSDoc
  - JSDoc에 @ts-check 지시자를 추가하면 오류가 발생할 수 있다.
  - 차근차근 타입 정보를 추가하자.
  - 빠른 수정으로 JSDoc 주석을 만들어 줄 수 있으나 정확하지 않을 수 있다.
  - 과정 중에서 임시로 사용하고 .ts 파일로 전환하자.

# 아이템 60. allowJs로 타입스크립트와 자바스크립트 같이 사용하기

> **마이그레이션 기간 중에 자바스크립트와 타입스크립트가 동시에 동작할 수 있도록 해야 합니다.**

- allowJS 컴파일러 옵션을 사용한다.
- outDir 옵션을 사용하면 타입스크립트가 outDir에 지정된 디렉터리에 소스 디렉터리와 비슷한 구조로 자바스크립트 코드를 생성하게 되고, ouDir로 지정된 디렉터리를 대상으로 기존 빌드 체인을 실행하면 된다.

# 아이템 61. 의존성 관계에 따라 모듈 단위로 전환하기

> **의존성과 관련된 오류 없이 작업하려면, 다른 모듈에 의존하지 않는 최하단 모듈부터 작업을 시작해서 의존성의 최상단에 있는 모듈을 마지막으로 완성해야 합니다.**

- 프로젝트 내의 존재하는 모듈은 서드파티 라이브러리에 의존하지만 반대는 아니기 때문에 서드파티 라이브러리 타입 정보를 가장 먼저 해결해야 한다.
- 외부 API에 대한 타입 정보도 마찬가지다.
- 마이그레이션할 때는 타입 정보만 추가하고 리팩터링을 해서는 안 된다.
  - 체크만 해 두고 나중에 처리하자
- 선언되지 않은 클래스 멤버
  - 타입스크립트에서는 클래스 멤버 변수를 명시적으로 선언해야 한다.
  - quick fix를 사용하고 넓은 범위로 추론된 타입은 수정해주자.
- 타입이 바뀌는 값
  - 자바스크립트에서 JSDoc과 @ts-check를 사용해 타입 정보를 추가한 상태라면 타입스크립트로 전환하는 순간 타입 정보가 무효화 된다는 것을 주의해야 한다.
  - JSDoc 타입 정보를 타입스크립트 타입으로 전환해 주는 빠른 수정 기능을 사용할 수 있다.
- 테스트 코드는 항상 의존성 관계도의 최상단에 위치하며 마이그레이션의 마지막 단계가 되는 것은 자연스럽다.

# 아이템 62. 마이그레이션의 완성을 위해 noImplicitAny 설정하기

> **noImplicitAny가 설정되지 않은 상태에서는 타입 선언에서 비롯되는 실제 오류가 숨어 있기 때문에 마이그레이션이 완료되었다고 할 수 없습니다.**

- 처음에는 로컬에만 설정하고 작업하는 것이 좋다.
  - 원격에서의 빌드 실패를 막기 위해
- 오류 개수를 진척도로 활용할 수 있다.
- `noImplicitAny` 보다 `"strict": true` 가 더 강력한 설정이다.
